<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>SABES QUE S PUEDES</title>
  <style>
    .error-message {
      color: white;
      background-color: #d9534f;
      padding: 15px;
      border-radius: 8px;
      margin: 20px auto;
      width: 80%;
      max-width: 400px;
      text-align: center;
      font-family: sans-serif;
    }
    .audio-hidden {
      display: none;
    }
    /* Estilos para la reproducci贸n robusta (Android/Universal) */
    #audioPlayer {
        display: none; /* Oculta el reproductor en el caso de la l贸gica robusta */
    }
    #unmuteMessage {
      color: gray;
    }
  </style>
</head>
<body>
  
  <script>
    // Funci贸n para detectar el sistema operativo (simplificado)
    function isAndroid() {
      const userAgent = navigator.userAgent || navigator.vendor || window.opera;
      return /android/i.test(userAgent);
    }

    function isIOS() {
      const userAgent = navigator.userAgent || navigator.vendor || window.opera;
      // Comprueba si es iPhone, iPad o iPod
      return /iPad|iPhone|iPod/.test(userAgent) && !window.MSStream;
    }

    // LISTA GLOBAL DE URLS (para ser utilizada por ambas l贸gicas)
    const audioUrls = [
        "https://raw.githubusercontent.com/zokosting/QR/main/5%20minutos%20de%20afirmaciones%20para%20recordarte%20lo%20incre%C3%ADble%20que%20eres.mp3",
        "https://raw.githubusercontent.com/zokosting/QR/main/Afirmaciones%20poderosas%20para%20volver%20a%20confiar%20en%20ti.mp3",
        "https://raw.githubusercontent.com/zokosting/QR/main/Agradecimientos.mp3",
        "https://raw.githubusercontent.com/zokosting/QR/main/Atrae%20un%20buen%20d%C3%ADa.mp3",
        "https://raw.githubusercontent.com/zokosting/QR/main/Cada%20Paso%20Cuenta.mp3",
        "https://raw.githubusercontent.com/zokosting/QR/main/Cosas%20a%20recordar%20este%20a%C3%B1o.mp3",
        "https://raw.githubusercontent.com/zokosting/QR/main/Dejar%20ir%20el%20pasado.mp3",
        "https://raw.githubusercontent.com/zokosting/QR/main/El%20poder%20de%20la%20historia%20que%20te%20cuentas.mp3",
        "https://raw.githubusercontent.com/zokosting/QR/main/Encuentra%20el%20balance%20en%20tu%20d%C3%ADa%20a%20d%C3%ADa.mp3",
        "https://raw.githubusercontent.com/zokosting/QR/main/Para%20encontrar%20paz%20hoy.mp3",
        "https://raw.githubusercontent.com/zokosting/QR/main/Recuerda%20tu%20valor.mp3",
        "https://raw.githubusercontent.com/zokosting/QR/main/Si%C3%A9ntete%20orgulloso%20de%20lo%20que%20eres.mp3"
    ];

    // LGICA ORIGINAL DE IPHONE (document.write con autoplay sin muted)
    function runIphoneLogic() {
      var randomIndex = Math.floor(Math.random() * audioUrls.length);
      var VARIABLE = audioUrls[randomIndex];

      // 1. Renderiza la etiqueta <audio> con el src aleatorio (L贸gica original del usuario)
      document.write('<audio autoplay>');
      document.write('<source src="' + VARIABLE + '" type="audio/mpeg">');
      document.write('Tu navegador no soporta el elemento de audio.');
      document.write('</audio>');
    }
    
    // LGICA ROBUSTA PARA ANDROID (Inyecci贸n de audio oculto + script de desmuteo)
    function runAndroidAudioLogic() {
      // Inyectamos la estructura HTML oculta (que usa los IDs y CSS predefinidos)
      document.write('<audio id="audioPlayer" autoplay muted>');
      document.write('<source id="audioSource" src="" type="audio/mpeg">');
      document.write('Tu navegador no soporta el elemento de audio.');
      document.write('</audio>');
      document.write('<p id="unmuteMessage"> Haz clic en cualquier parte para activar el sonido.</p>');

      // Inyectamos un script que inicialice el audio y el detector de clics
      document.write('<script>');
      document.write('(function() {'); // Funci贸n an贸nima para evitar conflictos de variables
      
      document.write('const randomIndex = Math.floor(audioUrls.length * Math.random());');
      document.write('const randomUrl = audioUrls[randomIndex];');
      
      document.write('const audioSource = document.getElementById("audioSource");');
      document.write('const audioPlayer = document.getElementById("audioPlayer");');
      
      document.write('audioSource.src = randomUrl;');
      document.write('audioPlayer.load();');
      document.write('audioPlayer.play().catch(error => { console.warn("Autoplay fall贸:", error); });');

      document.write('document.addEventListener("click", function() {');
      document.write('if (audioPlayer.muted) {');
      document.write('audioPlayer.muted = false;');
      document.write('const msg = document.getElementById("unmuteMessage"); if(msg) msg.style.display = "none";'); // Oculta mensaje
      document.write('} }, { once: true });');
      
      document.write('})();');
      document.write('</' + 'script>');
    }

    // Decide qu茅 renderizar
    if (isIOS()) {
      runIphoneLogic();
      // Si es iOS, se ejecuta la l贸gica original.
    } else if (isAndroid()) {
      // Ahora ejecuta la l贸gica robusta para Android
      runAndroidAudioLogic();
    } else {
      // Renderiza un mensaje neutro si no es iOS ni Android
      document.write('<div class="error-message">');
      document.write('锔 Dispositivo no identificado. Este contenido est谩 optimizado para iPhone (iOS) y puede no funcionar.');
      document.write('</div>');
    }
  </script>
  
  <!-- El resto del cuerpo se renderiza despu茅s de la inyecci贸n de document.write -->
</body>
</html>
